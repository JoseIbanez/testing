
- hosts: junos2
  connection: local
  #gather_facts: no
  remote_user: root
  roles:
  - Juniper.junos 
  tasks:

  - name: re-read facts after adding custom fact
    setup: filter=ansible_local

  - debug:
      var: item
  - debug:
      var: ansible_local
  - debug:
      var: "{{ ansible_local[inventory_hostname]['ip']['em1'] }}"
  - debug:
      var: "{{ ansible_local.j201.ip.em1 }}"


  - name: Load from a Jinja2 template.
    juniper_junos_config:
      host: "{{ ansible_host }}"
      load: 'merge'
      format: 'set'
      template: "../configs/olive-02.j2"
      vars:
        host: "{{ ansible_host }}"
        em1_ip: "{{ ansible_local[item]['ip']['em1'] }}"
    register: response
  - name: Print the complete response.
    debug:
      var: response
    
